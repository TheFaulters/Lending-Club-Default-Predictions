{
  "name": "Lending Club default predictions",
  "tagline": "A chronicle of our analysis of Lending Club data.",
  "body": "# Lending Club Default Predictions\r\n_Arthur Aguillar, Dwijo Goswami and James Fallon_  \r\n_Harvard University_   \r\n_CS109A: Introduction to Data Science_  \r\n_Final project_  \r\n\r\n## Data exploration\r\n\r\nOur task was to predict loan defaults using data provided by [Lending Club](https://www.lendingclub.com), a peer to peer lending service. The organization makes de-identified loan [data](https://www.lendingclub.com/info/download-data.action) available publicly. \r\n\r\nWe began by exploring the loan data. We categorized loans into those currently in delinquency or default (risky loans) and those with no payment violations (not risky loans).  \r\n   \r\nInitially, we wanted to explore some basic relationships. In the first instance, we were interested in how poorly loans had performed based on when they were issued.  \r\n\r\n**Figure 1:**  \r\n \r\n![](https://thefaulters.github.io/Lending-Club-Default-Predictions/Images/Loans-delinquency-bar.png)\r\n\r\nAdditionally, we were interested in whether higher risk borrowers (those with lower grades) consistently had to pay higher interest rates (and whether they indeed defaulted more often). We also wanted to make sure to account for imbalance in the dataset - since most borrowers don't default.  \r\n\r\n**Figure 2:**\r\n\r\n![](https://thefaulters.github.io/Lending-Club-Default-Predictions/Images/Risk.png) ![](https://thefaulters.github.io/Lending-Club-Default-Predictions/Images/Imbalance.png)\r\n\r\n## Cleaning  \r\nUsing all data from 2007 through the second quarter of 2016 resulted in a dataset with 1,119,194 loan observations. The dataset had 111 variables - pieces of information on each borrower ranging from the interest rate on the loan to a personal description or sales pitch describing the purpose of the loan.    \r\n\r\nIt is clear from Figure 1 above that risky loan rates decrease dramatically for loans that have been active for a shorter period of time. We feared that this could be due to the short duration of those loans relative to their maturity, and that using these to build a predictive model would result in identifying risky borrowers as not risky borrowers. So we dropped all 2016 data, using only data from 2007 through 2015.\r\n\r\nTo run most of our models, we needed the data to be in numerical format. However, the dataset was full of various datatypes. So our cleaning process mostly consisted of ensuring all numbers were indeed in numerical format, and generating dummy variables for categorical variables like loan grade and state of residence. Following feedback from our TF, we also dropped variables that could only be determined after the loan was issued. For example, delayed payments or late fees.   \r\n\r\nAfter the cleaning process, the final dataset contained 887,440 observations, 216 predictor variables and one binary response variable: a 1 for risky loans and a 0 for safe loans.  \r\n\r\n**Figure 3: Cleaning**    \r\n![](https://thefaulters.github.io/Lending-Club-Default-Predictions/Images/cleaning_1.png)![](https://thefaulters.github.io/Lending-Club-Default-Predictions/Images/cleaning_2.png)  \r\n![](https://thefaulters.github.io/Lending-Club-Default-Predictions/Images/cleaning_3.png)![](https://thefaulters.github.io/Lending-Club-Default-Predictions/Images/cleaning_4.png)  \r\n\r\n## Random forests   \r\n**Figure 4:**  \r\n\r\n![](https://thefaulters.github.io/Lending-Club-Default-Predictions/Images/RF_opt.png)\r\n\r\n## Logistic regression     \r\n**Figure 5:**  \r\n![](https://thefaulters.github.io/Lending-Club-Default-Predictions/Images/l1_opt.png)\r\n\r\n## Support vector classifier  \r\n\r\nNext, we used a support vector machine to classify loan risk. We chose SVM because our dataset is very large and features a binary response variable. Our approach was guided by James et al pp 344-35 and Hsu et al.  \r\n\r\nWhile we had expected SVM to be more efficient than other models, it was in fact one of the slowest models we attempted. As a result, we tuned with 1% of the dataset (8,874 observations), trained with 5% and validated with 5% (44,372 observations).   \r\n\r\nOn the guidance of Hsu et al, we tuned for gamma - a parameter specific to the radial kernel - and C - the misclassification parameter. We also scaled the x input to have mean 0 and standard deviation 1. As with our other models, we balanced the class weights to account for the underrepresentation of risky loans in the overall dataset.\r\n\r\n**Results:**\r\n\r\n## Comparative results: ROC and Precision Recall\r\n\r\n## Sentiment analysis\r\n\r\nWhile we had initially dropped the borrower's description, we wanted to revisit this variable to conduct sentiment analysis. Essentially, we hoped to use the borrower's loan pitch to see if descriptions contained any particular red flags.  \r\n\r\nWe first performed a visual analysis of the words used more often by risky borrowers and non risky borrowers. It is interesting to observe that the word \"card\" is the most used by risky borrowers, while the word loan is the most used by non risky borrowers: One simple intuition for that is that risky borrowers are often refinancing their older debts as well as borrowing for consumption reasons, while non risky borrowers apply for loans due to different reasons.  \r\n\r\n**Figure x: Risky Borrowers**  \r\n![](https://thefaulters.github.io/Lending-Club-Default-Predictions/Images/risky_borrowerss.png)\r\n\r\n**Figure x: Safe Borrowers**  \r\n![](https://thefaulters.github.io/Lending-Club-Default-Predictions/Images/nrisky_borrowerss.png)  \r\n  \r\nWe now select our preferred model. We will optimize - by testing distinct values for penalties and performing cross validation - 2 kinds of weighted logistic regressions, one that uses a l1 penalty (analogous to a Lasso, therefore excluding the least explanatory variables by \"shrinking\" coefficients up to 0), and the other that uses a l2 penalty (with a regulariation parameter analogous to a Ridge, that shrink coeffcients towards zero, but not to the point of excluding coefficients. We also use weighted models due to the imbalances on the response variable. Under the penalties that maximize accuracy, our weighted logistic regression with penalty l1 performs 85.8% of accurate classifications, while our weighted logistic regression with l2 penalty perfroms 75.93% of accurate classifications. However, the model with l2 penalty performs better in the ROC curve, that is, the model is more accurate under the umbalanced class. \r\n\r\nOur preferred model therefore performs 75.93% of accurate classifications, with a precision of 86.4% for class 0 and  and 17.5% for class 1. This means that we are performing an accurate classification of a very small percentage of the actual risky loans.    \r\n\r\n**Figure x: ROC curve for sentiment analysis**  \r\n![](https://thefaulters.github.io/Lending-Club-Default-Predictions/Images/sent_ROC.png)  \r\n\r\nIt is clear from our low accuracy rating for the risky class, as well as the ROC curve above, that this model was not successful compared to our other approaches. If we were to take this further we would explore conducting other sorts of analysis on the descriptions - for example exploring libraries that might help us identify typos or bad grammar. While we could potentially draw more predictive power from such an approach, we will not pursue this approach in the context of this project.  \r\n\r\n### References\r\n\r\nCeyhan S, Shi X and Leskovec J (2011). \"Dynamics of bidding in a P2P lending service: effects of herding and predicting loan success.\" _Proceedings of the 20th International Conference on the World Wide Web (pp 547-556)._\r\n\r\nHsu C, Chang C and Lin C (2016). \"A Practical Guide to Support Vector Classification.\" _National Taiwan University, Department of Computer Science._\r\n\r\nIyer R, Khwaja A, Luttmer E, Shue K (2009) “Screening in New Credit Markets: Can Individual Lenders Infer Borrower Creditworthiness in Peer-to-Peer Lending?” _Harvard Kennedy School of Government, Faculty Research Working Papers Series: RWP09-031 (September 2009)._\r\n\r\nJames G, Witten D, Hastie T and Tibshirani R (2015). \"An Introduction to Statistical Learning with Applications in R.\" _New York: Springer._\r\n\r\n[Lending Club Statistics.](https://www.lendingclub.com/info/download-data.action) _Lending Club._\r\n\r\nPander J and Srinivasan M (2011). [\"Predicting Probability of Loan Default.\"](http://cs229.stanford.edu/proj2011/PandeySrinivasan-PredictingProbabilityOfLoanDefault.pdf) _Stanford University, CS229 Project report._ \r\n\r\nTsai K, Ramiah S and Singh S (2014). [\"Peer Lending Risk Predictor\"](http://cs229.stanford.edu/proj2014/Kevin%20Tsai,Sivagami%20Ramiah,Sudhanshu%20Singh,Peer%20Lending%20Risk%20Predictor.pdf) _Stanford University, CS229 Project Report._\r\n\r\n### Acknowledgements\r\nWe would like to thank our Teaching Fellow Qing Zhao for her guidance and support on this project. We would also like to thank the teaching staff of CS109a for their feedback and suggestions.",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}